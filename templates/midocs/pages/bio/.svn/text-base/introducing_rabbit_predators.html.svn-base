{% extends "midocs/page_base.html" %}{% load mi_tags %}{% block content %}
{% index_entry "predator-prey model" %}
{% index_entry "Lotka-Volterra model" %}
{% title "Introducing rabbit predators" %}
{% description "Exploring the interactions between fox and rabbit populations when foxes are introduced to an exploding population of rabbits." %}

{% navigation_tag "background" "Background" %}
<h4>Background</h4>
<p>It all started innocently enough.  A family let loose a few rabbits on Foxless Island, thinking the rabbits would be happier outside than inside being rough handled by their children.  Without predators on the island, though, the rabbits became a little too happy, and soon the island became overrun by rabbits.</p>

<p>The ability for rabbits to multiply has turned into a big headache for you, the head the Foxless animal control team (FACT).  In your {% intlink controlling_rabbit_population %}first attempt to control the rabbit population{% endintlink%}, you and your team tried &ldquo;harvesting&rdquo; each month a fixed fraction of the rabbit population, hoping to reach a steady population of around a thousand rabbits.  The effort turned into a colossal failure, as no matter what fraction you tried, you seemed to be either harvesting too many or too few rabbits.  You couldn't get the balance right.</p>

<p>Then, you tried being smarter, counting the number of rabbits on the island each month, and adjusting the fraction of rabbits harvested based on that count.  This effort seemed promising, but it was much too difficult for you and your small team to keep up.  For one thing, counting rabbits is hard work, and FACT simply doesn't have enough resources to keep up the monthly count.  You can't push your team members any harder, as they have begun to rebel against your demands for frequent rabbit counting.  Moreover, your &ldquo;rabbit harvesting&rdquo; activities have made your solution increasingly unpopular among key segments of Foxless residents.  To keep the situation from spinning further out of control, you must devise a new method for rabbit control.</p>

<p>While brooding about the incorrigible nature of Foxless human and animal populations, you realize the perfect solution to your woes.  Introducing foxes to the island will provide a natural way to control the rabbit population.   Foxes don't need to count rabbits each month in order to decide how many rabbits to eat. They can respond naturally to fluctuations in the rabbit population size, reproducing to yield more foxes should more rabbits need to be eaten.  The best part is that the foxes will do their work for free and without complaining.</p>

<p>Before you propose this radical change to the Foxless community, you better do your homework well.  You can already hear the objections.  &ldquo;The fox population will explode, and soon we'll have a bigger problem with the foxes than we had with the rabbits.&rdquo;  &ldquo;The foxes will eat all the rabbits and we won't have any rabbits left to watch.&rdquo;  You'll make sure you are prepared to address all these concerns before you propose your fox solution.</p>


{% navigation_tag "model" "Model" %}
<h4>The mathematical model</h4>

<p>The best way to have a persuasive argument in factor of your proposal, you believe, is to have it backed by a mathematical model.  You decide to make some important changes from your  {% intlink controlling_rabbit_population %}initial rabbit model{%endintlink%}.  The first change is to move from discrete time to continuous time.  That way, you'll have a more impressive sounding <em>differential equation</em> model.  You let $t$ represent time in years, denoting the rabbit population size at time $t$ by $r(t)$ and the fox population size at time $t$ by $p(t)$ ($p$ for predator).</p>

<p>Now that you use $r$ for the rabbit population size, you can't use that letter any more for growth rate.  Since you imagine that Greek letters will make the model look sophisticated, you choose $\alpha$ (alpha) for the growth rate of the rabbits.  Then, in the absence of the foxes, the rabbits would evolve according to the differential equation 
\begin{align}
  \diff{r}{t} = \alpha r.
  \label{rabbits_alone}
\end{align}
Since $\alpha$ is positive, the equation will lead to exponential growth of the rabbit population size, a phenomenon you are too familiar with.</p>

<p>You'll model the foxes a bit differently.  Assuming that they depend on rabbits for food, their population size should shrink in the absence of rabbits.  Using $\gamma > 0$ (gamma) for this rate of decay, you can model the hungry, rabbitless, fox population as
\begin{align}
  \diff{p}{t} = - \gamma p.
  \label{foxes_alone}
\end{align}
</p>

<p>As a warm up, solve the foxless rabbit equation \eqref{rabbits_alone} and the rabbitless fox equation \eqref{foxes_alone}, to obtain an expression for these separate populations.  (Guessing the solution is an OK method.)  What happens to the rabbit population as time increases?  What happens to the fox population as time increases?</p>

<p>You main use of the model is to show how the foxes will decrease the rabbit population.  To model this effect, you subtract a term off the $\diff{r}{t}$ that accounts for the decrease in rabbits due to fox predation.  To keep the model simple, you decided to make the rate of rabbit kills be proportional to the number of rabbits and the number of foxes: $\beta r p$, where the Greek letter $\beta$ (beta) is a parameter that indicates how quickly a fox can reduce the rabbit population.  The rabbit equation becomes
\begin{align}
  \diff{r}{t} = \alpha r - \beta r p.
  \label{rabbits_with_foxes}
\end{align}
</p>

<p>If the fox population size $p$ remained constant, this harvesting by the foxes is strikingly similar to your initial harvesting strategy, where a fix fraction were harvested each month.  The new feature that the foxes can increase their population size when there are plenty of rabbits around.  Again, to keep everything as simple as possible, you model the addition to the fox population as being proportional to the rate that rabbits are eaten.  You add a term to the fox equation of the form $\delta r p$, where $\delta$ (delta) captures how efficiently the eaten rabbits are turned into new foxes.  (Since each rabbit consumed doesn't lead to a new fox, you expect that $\delta$ should be quite a bit smaller than $\beta$.)  The fox equation becomes
\begin{align}
  \diff{p}{t} = - \gamma p + \delta rp.
  \label{foxes_with_rabbits}
\end{align}
</p>
<p>Equations \eqref{rabbits_with_foxes} and \eqref{foxes_with_rabbits} form a system of two autonomous differential equations for the joint evolution of the rabbit and fox populations.  This equations, known as the {% extlink "http://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equation" %}Lotka-Volterra equations{%endextlink%}, are a simple example of predator-prey equations that model the interactions among these two populations.</p>

{% navigation_tag "solving" "Solving" %}
<h4>Solving the model</h4>

<p>The next step is to determine what the equations predict about the future of the rabbit and fox population in the event that you add some foxes to the island.  Having these four unknown parameters $\alpha$, $\beta$, $\gamma$, and $\delta$ is too confusing, so you realize you better give them specific values.  Based on your intuition on animal behavior, you decide to set the parameters to $\alpha=1$, $\beta=0.01$, $\gamma=0.5$, and $\delta = 0.0005$.  Since you aren't certain these are exactly the right values, you'll have to check out the effect of changing them later.</p>

<p>You are left with the system of equations
\begin{align}
  \diff{r}{t} &=  r - 0.01 r p\notag\\
  \diff{p}{t} &= - 0.5 p + 0.0005 rp.
  \label{system_with_parameters}
\end{align}
They look simple enough, but you don't know how to solve them.  To determine what they predict about the future of the rabbits and foxes, you'll need to somehow estimate the solution.</p>

{% navigation_tag "forwardeuler" "Solving" "Forward Euler" %}
<h5>A Forward Euler approximation</h5>

<p>As best as you can tell, the rabbit population has grown to about 3000 rabbits.  Your plan is to introduce 70 foxes to Foxless Island.  You'll use those values as your initial conditions.  By plugging those values, you calculate that the initial rates of change are
\begin{align*}
  \diff{r}{t}\bigg|_{t=0} &=  3000 - 0.01 (3000)(70)=900\notag\\
  \diff{p}{t}\bigg|_{t=0} &= - 0.5(70) + 0.0005 (3000)(70)= 70.
\end{align*}
Oh no, the rabbit population is still growing!  Aren't the foxes doing their job?  It looks like 70 foxes isn't enough to keep the rabbits in check.  But, the fact that the fox population is growing at a healthy rate is promising.</p>

<p>For a crude initial approximation, you decide to assume the rabbit and fox population grow at these rates for a whole year.  With this assumption, the populations after the first year are
\begin{align*}
  r(1) &= 3000 + 900(1) = 3900\\
  p(1) &= 70 + 70(1) = 140.
\end{align*}
</p>

<p>Will the increase in the fox population be enough to start to bring down the rabbit population?  With the new population sizes in hand, you estimate the rates of change at the beginning of the second year:
\begin{align*}
  \diff{r}{t}\bigg|_{t=1} &=  3900 - 0.01 (3900)(140)=-1560\notag\\
  \diff{p}{t}\bigg|_{t=1} &= - 0.5(140) + 0.0005 (3900)(140)= 203
\end{align*}
Yes, now the rabbit population size is coming down quite nicely, even faster than it went up during the first year.</p>

<p>Finish the calculation to estimate the population sizes $r(2)$ and $p(2)$ after the second year.  Then, calculate the rates of change at the beginning of the third year (i.e., at $t=2$) and estimate the population sizes $r(3)$ and $p(3)$ after the third year.</p>

{% comment %}
t=0
r=3000
p=70

drdt = 3000-0.01(3000)(70)=900
dpdt = -0.5(70)+0.0005(3000)(70) = 70

t=1
r=3900
p=140

drdt = 3900-0.01(3900)(140)=-1560
dpdt = -0.5(140)+0.0005(3900)(140) = 203

t=2
r=2340
p=343

drdt = 2340-0.01(2340)(203)=-2410.2
dpdt= -0.5(203) + 0.0005(2340)(203) = 136

{% endcomment %}

<p>Does your estimate of $r(3)$ and $p(3)$ make sense?  (The presence of fractional rabbits or foxes isn't a problem.  There's something more fundamentally wrong here.)  The foxes seemed to have taken care of the rabbits all right, but seemed to overstep what is realistic.   What went wrong?  What could you do to fix it?  Do you need to change the model or just the way you are estimating its solution?</p>

{% navigation_tag "visualization" "Solving" "Computer visualization" %}
<h5>Computer visualization</h5>

<p>After some though, you realize you could probably fix the above Forward Euler estimation by taking time steps smaller than a year.  Since you doubt you could do all the required calculations accurately yourself (and you don't feel like spending all day crunching numbers), you decide to hire a computer programmer to create a tool to let you see the solution to the differential equations.  You figure the programmer will be worth the expense, as such a tool will also be useful in persuading others that you have a good solution.</p>

<p>The programmer scoffs at your use of the Forward Euler algorithm.  Why are you using an algorithm from the 1700's, he asks, when you can at least get into the 1900's with the {% extlink "http://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods" %}Runge-Kutta algorithm{%endextlink%}?  You have no idea what he is talking about, but you like the solution he made for you,  which is shown in the following applet.</p>  

<p>Use the applet to investigate what happens to the rabbits and foxes when you use the above parameters and start with 3000 rabbits and 70 foxes.  How does this result compare to your estimate via Forward Euler and a 1 year time step?</p>

<p>Describe the behavior of the system as time evolves?  Using the model equation, explain why this occurs.  Does this make sense for the biological system?  Do you believe the model?  Do you expect the evolution of the rabbit and fox populations to have this type of behavior?</p>

{% boxedapplet lotka_volterra_versus_time_population_display %}



<p>You find the oscillatory behavior of the solution to your system of equations a bit surprising.  You wonder if may the result was just a strange coincidence given that you started with 3000 rabbits and 70 foxes.  If you try different initial conditions, do you get similar behavior?  Does the solution still oscillate?  If it does oscillate, does the oscillation seem to take the same or different amount of time?</p>

<p>Maybe the oscillations are just an artifact of the value of the four parameters that you chose.  Change the parameters by small amounts at a time, and see if the behavior of the system is roughly similar or has dramatically different behavior.</p>


{% navigation_tag "phaseplane" "Solving" "Phase plane visualization" %}
<h5>Phase plane visualization</h5>

<p>The computer programmer also made a second visualization tool, shown below.  Not only does this applet show the plots of $r$ and $p$ versus time, but it also shows a representation of the state $(r,p)$ of the system as a phase plane plot of $p$ versus $r$.  In the phase plane, the oscillation looks like loop.</p>

{% boxedapplet lotka_volterra_phase_plane_versus_time_population_display %}

<p>The phase plane visualization helps you better see how the oscillations work and what controls the size of the oscillations.  By dragging the initial condition point $(r(0),p(0))$ around the phase plane, you can see how the initial conditions influence the oscillations.  What initial conditions lead to the largest oscillations in the population sizes?  What initial conditions lead to the smallest oscillations?  Can you find an initial condition where the oscillations is essentially eliminated?</p>



{% navigation_tag "equilibria" "Solving" "Equilibria" %}
<h5>Equilibria</h5>

<p>As always, equilibria are an important feature of a dynamical system and can be used to understand the behavior of the system.  For the two-dimensional system \eqref{system_with_parameters}, an equilibrium is a point $(r^*, p^*)$ in the phase plane where both derivatives $\diff{r}{t}$ and $\diff{p}{t}$ are zero.  If you start with an initial condition that is an equilibrium, the system will stay at the value forever.</p>

<p>Show that the system \eqref{system_with_parameters} has the trivial equilibrium $(0,0)$ with no rabbits or foxes.  You just need to plug in $(r,p)=(0,0)$ into the system and show that both right hand sides are zero.  This makes sense, as we shouldn't get rabbits or foxes materializing out of nowhere.</p>

<p>Is there another equilibrium to the system?  When you were exploring the behavior of the system for different initial conditions in the phase plane, did you find a point where the oscillations are essentially eliminated?  If you found a point where the system did not change at all, then you found an equilibrium.  You should be able to get an idea of its value by exploring the phase plane.  From that, you may be able to guess what are the values of $r$ and $p$ at the non-zero equilibrium.</p>

<p>You can also calculate the equilibria analytically from the equations \eqref{system_with_parameters}.  Set both equations equal to zero.  You will have two equations and two unknowns.  For an equilibrium, both equations have to be zero.  To find the points, you can easily factor both equations.  You should be able to confirm the results you obtained by exploring the phase plane.</p>

<p>Are the equilibria stable or unstable?  If you start with any initial condition close to the equilibrium, does the solution stay close to that equilibrium or even converge to the equilibrium?  In that case, it is stable.  Can you find an initial condition close to the equilibrium for which the solution diverges away from the equilibrium?  In that case, the equilibrium is unstable.  Classify both equilibria as stable or unstable.</p>

<p>For the trivial equilibrium (0,0), we know that if we start without any rabbits, the system will evolve toward to the equilibrium.  However, that is not enough to state that the equilibrium is stable.  If you can find any other initial conditions close to (0,0) from which the solution moves away from (0,0), that's enough to conclude that the equilibrium is unstable.</p>


{% navigation_tag "stupidity" "Stupidity" %}
<h4>Model stupidity</h4>

<p>What does the model predict will happen if you introduced only two foxes rather than 70?  Look closely at the values of $r(t)$ after the rabbit population size is brought down from its initial peak.  Does that value make any sense?  Or, more importantly, does it make sense that the rabbit population eventually recovers from that value to shoot upward again?  What should have happened to the rabbit population if it got that low?  Also, does it make any sense that the fox population survives for many years on so few rabbits?  (The model isn't suppose to be including other food sources for the foxes.)  If you want people to believe your model, you probably shouldn't focus on such initial conditions.</p>

{% navigation_tag "conclusion" "Conclusion" %}
<h4>Conclusion</h4>

<p>What can you conclude from your model analysis?  Can you make a convincing case that introducing foxes to Foxless Island will help control the rabbit population?  Even if it doesn't show that one will get good results in all cases, can you use the model to develop a strategy that will lead to a more or less stable population of around a thousand rabbits?</p>

<p>If we estimate that Foxless currently has around 3000 rabbits, can you get to a more or less stable population of a thousand rabbits just by introducing an appropriate number of foxes?  Can you get to this thousand rabbit population if you help the foxes out by initially harvesting some rabbits yourself?</p>

<p>Does the model help you address the two objections that you envisioned people making?  Why or why not?</p>


{% navigation_tag "questions" "Questions" %}
<h4>Summary of questions</h4>

<p>To aid you in writing up a report on your results, we summarize the main questions posed above that you should be able to answer and added a few more questions.</p>


<ol>
  <li><p><b>The mathematical model</b></p>

    <ol><li>Solve the foxless rabbit equation \eqref{rabbits_alone} and the rabbitless fox equation \eqref{foxes_alone}, to obtain an expression for these separate populations.  (Guessing the solution is an OK method.)  What happens to the rabbit population as time increases?  What happens to the fox population as time increases?</li>
      <li>Describe the meaning of the four parameters $\alpha$, $\beta$, $\gamma$, and $\delta$.</li>
      <li>Why might the predator-prey model of equations \eqref{rabbits_with_foxes} and \eqref{foxes_with_rabbits} control the rabbit population better than a model where you continually harvest a fixed fraction of rabbits?  The latter model might look like
	$$\diff{r}{t} = \alpha r - \beta r.$$
	(Hint: how does the fact the the fox population size responds to fluctuations in the rabbit population size relieve some of the problems of the fix fraction harvesting model.)</li>
    </ol>
  <li><p><b>A Forward Euler approximation</b></p>
    <ol><li>Finish the calculation to estimate the population sizes $r(2)$ and $p(2)$ after the second year using the Forward Euler algorithm with a time step of 1 year.</li>
      <li>Take another step of the Forward Euler algorithm.  Calculate the rates of change at the beginning of the third year (i.e., at $t=2$) and estimate the population sizes $r(3)$ and $p(3)$ after the third year.</li>
      <li>Does your estimate of $r(3)$ and $p(3)$ make sense?  (Don't worry about fractional rabbits or foxes.)   What went wrong?  What could you do to fix it?  Do you need to change the model or just the way you are estimating its solution?</li>
    </ol>
  <li><p><b>Computer visualization</b></p>

    <ol><li>Use the applet to investigate what happens to the rabbits and foxes when you use the parameters of equation \eqref{system_with_parameters} and start with 3000 rabbits and 70 foxes.  How does this result compare to your estimate via Forward Euler and a 1 year time step?</li>
      <li>Describe the behavior of the system as time evolves?  Using the model equation, explain why this occurs.  Does this make sense for the biological system?  Do you believe the model?  Do you expect the evolution of the rabbit and fox populations to have this type of behavior?</li>
      <li>If you try different initial conditions, do you get similar behavior?  Does the solution still oscillate?  If it does oscillate, does the oscillation seem to take the same or different amount of time?</li>
      <li>Change the parameters $\alpha$, $\beta$, $\gamma$, and $\delta$ by small amounts.  Is the behavior of the system is roughly similar or does it has dramatically different behavior.</li>
    </ol>

  <li><p><b>Phase plane visualization</b></p>
    <ol><li>In the phase plane, one can just plot the locations of the point $(r(t),p(t))$ for a range of times $t$.  The result is a curve in the phase plane.  Can you tell by looking just at the curve in the phase plane, how quickly the rabbit and fox populations are changing with time?   As time $t$ evolves does the state $(r(t),p(t))$ move at the same speed at all times?  Describe where in the phase plane the state $(r(t),p(t))$ moves faster or slower.</li>
      <li>By exploring the how trajectories (the curves) depend on the initial condition point $(r(0),p(0)$, determine which initial conditions lead to largest and the smallest oscillations in the population size.  Can you find an initial condition where the oscillations is essentially eliminated?</li>
    </ol>

  <li><p><b>Equilibria</b></p>
    <ol><li>Show that the system \eqref{system_with_parameters} has the trivial equilibrium $(0,0)$ with no rabbits or foxes.</li>
      <li>Is there another equilibrium to the system?  By exploring the behavior of the system in the phase plane, for what non-zero values of $r$ and $p$ does the system seem to be near a steady state.</li>
      <li>Calculate the values of the equilibria analytically from the equations \eqref{system_with_parameters}.</li>
      <li>Do the equilibria seem to be stable or unstable?  Justify your conclusions.</li>
    </ol>
     
  <li><p><b>Model stupidity</b></p>
    <ol><li>What does the model predict will happen if you introduced only two foxes rather than 70, i.e., with initial conditions $(r(0),p(0))=(3000,2)$?</li>
      <li>Explain what doesn't make sense about the prediction of the model for these initial conditions.</li>
    </ol>
    
  <li><p><b>Conclusion</b></p>
    <ol><li>What can you conclude from your model analysis?  Can you make a convincing case that introducing foxes to Foxless Island will help control the rabbit population?  Even if it doesn't show that one will get good results in all cases, can you use the model to develop a strategy that will lead to a more or less stable population of around a thousand rabbits?</li>
      
      <li>If we estimate that Foxless currently has around 3000 rabbits, can you get to a more or less stable population of a thousand rabbits just by introducing an appropriate number of foxes?  Can you get to this thousand rabbit population if you help the foxes out by initially harvesting some rabbits yourself?</li>
      <li>Does the model help you address the two objections that you envisioned people making (at the end of the Background section)?  Why or why not?</li>
    </ol>
  </li>
</ol>

{% endblock %}
