{% extends "midocs/page_base.html" %}{% load mi_tags %}
{% block extrastyle2 %}
<style type="text/css">p.small {font-size:90%;}</style>
{% endblock %}
{% block content %}
{% index_entry "bacterial growth" "logistic model" %}
{% index_entry "discrete dynamical system" "example" %}
{% index_entry "logistic growth" %}
{% title "Developing a logistic model to describe bacteria growth" %}
{% description "Modeling the slowing growth rate caused by environmental carrying capacity in bacteria growth data." %}

{% navigation_tag "introduction" "Introduction" %}
<h4>Introduction</h4>

{% boxedvideo bacteria_growth_logistic_model %}

<p>When we {% intlink bacteria_growth_initial_model %}modeled the initial growth of the bacteria <i>V. natriegens</i>{% endintlink%}, we discovered that an {% intlink exponential_growth_decay_discrete %}exponential growth model{%endintlink%} was a good fit to the first 64 minutes of the bacteria growth data.  However, the last data point at 80 minutes was lower that predicted by the exponential growth model.  It appeared that the growth rate was slowing down during the last 16 minutes of that data set.  A likely explanation is that the population was beginning to {% intlink environmental_carrying_capacity%}exhaust its environment{%endintlink%}.</p>

<p>The {% intlink environmental_carrying_capacity%}logistic growth model{%endintlink%} is a model that includes an environmental carrying capacity to capture how growth slows down when a population size becomes so large that the resources available become limited.  Our goal is to apply this model to the bacteria growth data to see if the pattern in the data can be explained by such a model.  Fortunately, we have more data than we revealed in the {% intlink bacteria_growth_initial_model %}initial bacteria model page{%endintlink%}.  We actually have data from growing <i>V. natriegens</i> in a flask for 160 minutes, as shown in the following table.  The population was measured every 16 minutes, and the time index variable $t$ measures the number of these 16 minute intervals since the beginning of the experiment.</p>

<table class="basic centered compact" style="width:50%">
<caption>Measurements of bacterial density at pH 6.25.<br/>
The units of &ldquo;Population Density&rdquo; are those of
absorbance as measured by a spectrophotometer.</caption>
<tr><th>Time (min)</th><th>Time index $t$</th><th>Population Density</th></tr>
<tr><td>0</td><td>0</td><td>0.022</td></tr>
<tr><td>16</td><td>1</td><td>0.036</td></tr>
<tr><td>32</td><td>2</td><td>0.060</td></tr>
<tr><td>48</td><td>3</td><td>0.101</td></tr>
<tr><td>64</td><td>4</td><td>0.169</td></tr>
<tr><td>80</td><td>5</td><td>0.266</td></tr>
<tr><td>96</td><td>6</td><td>0.360</td></tr>
<tr><td>112</td><td>7</td><td>0.510</td></tr>
<tr><td>128</td><td>8</td><td>0.704</td></tr>
<tr><td>144</td><td>9</td><td>0.827</td></tr>
<tr><td>160</td><td>10</td><td>0.928</td></tr>
</table>
 
<p>When fitting an exponential growth model to the data from the first 5 intervals, we discovered that a relative growth rate of $r=2/3$ described the first four data points well.  If we let $P_t$ be the population density in time bin $t$, then the initial model ({% intlinkeq bacteria_growth_initial_model initial_model %}of the initial model page{%endintlinkeq%}) was
\begin{gather*}
  P_{t+1}-P_{t} = \frac{2}{3} P_t.
\end{gather*}
For the fifth point, however, the data was a little lower than the model prediction.  If the population growth rate is slowing down, we expect the discrepancy between the model prediction and the data to get even worse for later times.  As shown in the below figure, this expectation is born out.  The data is shown by the blue circles and the model prediction by the red X's.  For the sixth time point and beyond, the exponential growth model grossly overestimates the population size.</p>

{% image bacteria_density_versus_time_long %}

<p>This deviation between the data and the model bears a reasonable resemblance to the {% appletlink logistic_and_exponential_growth %}comparison between logistic and exponential growth{%endappletlink%} that we observed when modeling the effects of {% intlink environmental_carrying_capacity%}environmental carrying capacity{%endintlink%}.  We will look for a logistic equation that approximates the <i>V. natriegens</i> data.  The equation should be of the form
\begin{equation}  \label{logistic}
P_{t+1} - P_t = r \times P_t \times \left(1 - \frac{P_t}{M} \right).
\end{equation}
In order to use such a discrete dynamical system model, we must have an initial value, $P_0$, which we can take directly from the data.  The more challenging task will be to find reasonable values for the low density growth rate $r$ and the carrying capacity $M$.</p>

<p>To accomplish this task, we are going to use {% extlink "http://www.geogebra.org/"%}Geogebra{%endextlink%}.  Although it might be possible to accomplish the task using the below applet as embedded in this web page, it will be a lot easier if you  {% extlink "http://www.geogebra.org/cms/en/download" %}download the Geogebra program{%endextlink%} onto your own computer (click the Webstart button).  Then, from the {% appletlink bacteria_density_data %}bacteria density data applet page{%endappletlink%} (which you can also view by clicking on &ldquo;More information about applet&rdquo; in the applet's caption) download the applet file and open it in Geogebra.  In this way, you can save or print your work and will have more options available to work with.</p>

{% boxedapplet bacteria_density_data %}

{% navigation_tag "the_old" "The old" %}
<h4>Trying the old method: plotting population change versus density</h4>

<p>In developing the exponential model for bacteria growth, a critical step was to plot the population change $P_{t+1}-P_t$ in one time interval versus the population density $P_t$ at the beginning of the interval.  By {% appletlink bacteria_density_change_versus_density_line %}fitting the resulting data points by a line through the origin{%endappletlink%}, we obtained the growth rate $r$ as the slope of the line.  What would happen if we attempted to follow this procedure with the full bacteria growth data?</p>

<p>Using the {% appletlink bacteria_density_data %}bacteria density data applet file{%endappletlink%} that you are running from within Geogebra installed on your computer, create a plot of population change $P_{t+1}-P_t$ versus population density $P_t$ and see if the data is well fit by a line through the origin. Use the spreadsheet panel to calculate the population change $P_{t+1}-P_t$ as follows.</p>

<p>Create a column to the right of the data with a heading such as &ldquo;change.&rdquo; You can let the spreadsheet calculate the differences for you.  For example, in cell D2, type &ldquo;=&rdquo;, click the C3 cell (which is $P_1$), type &ldquo;-&rdquo;, click the C2 cell (which is $P_0$), then press Enter.  If all goes well, cell D2 should then contain $P_1-P_0$, which is 0.014.  You can repeat this procedure for the remaining cells in the column or save yourself work by copying and pasting the result into the rest of the column.  (The copy and paste keys, Ctrl+C and Ctrl+V, won't work in the applet when it's embedded in the web page.  You'd need to select D2 and drag the little square that appears in the lower right corner of the cell to extend the formula to the rest of the column.)</p>

<p class="small">If you copy the formula to the last row corresponding to time index 10, Geogebra will automatically insert a 0 in the population column of the following row, giving a population density of zero in time index 11 (i.e., $P_{11}=0$) and a negative change for $P_{11}-P_{10}$. Keeping that negative change around will mess up the data analysis, so be sure to delete it if you inadvertently create it.</p>

<p>To plot points in the graphics panel at the left from the data in the spreadsheet, there is a trick.  If a spreadsheet cell contains data of the form $(x,y)$, where $x$ and $y$ are numbers, then Geogebra will plot a point at the coordinates $(x,y)$ in the graphics panel.  According to our analysis with the {%intlink bacteria_growth_initial_model %}exponential bacteria growth model{%endintlink%}, if we plot the change versus population size, the exponential growth model predicts the points should lie on a slope through the origin.  To test the validity of this model plot the values $P_{t+1}-P_{t}$ that you just calculated in column D versus the population size in column C.  Create the points in column E.  Label the column with an appropriate label in cell E1.  Then, type &ldquo;=(&rdquo; in cell E2, click cell C2, type &ldquo;,&rdquo;, click cell D2, and press Enter.  (You don't have to type the final &ldquo;)&rdquo; as Geogebra can add that in for you.)  Copy cell C2 to the rest of column C, and you should see the points $(P_{t},P_{t+1}-P_{t})$ appear in the graphics panel, similar to how they are shown in the {% appletlink bacteria_density_change_versus_density_line %}applet used for initial bacteria data{%endappletlink%}.</p>

<p class="small">If you don't like the labels such as E2 to appear, you can highlight the points either in the graphics window or the spreadsheet, right-click (Mac OS: Ctrl-click)  and select Object Properties.  In the Basic tab, unselect Show Label.  You can also change the color and style of the points from this dialog box, if you like.
</p>

<p>What do you observe about the pattern of the points $(P_{t},P_{t+1}-P_t)$?  Explain how this plot informs you about the growth rate of the bacteria.</p>

{% navigation_tag "the_new" "The new" %}
<h4>A new approach: plotting relative population change</h4>

<p>According to the exponential growth dynamical system
$$P_{t+1}-P_{t}=rP_t,$$
the change $P_{t+1}-P_{t}$ is proportional to the population density $P_t$ with proportionality constant $r$.  In other words, the population change $P_{t+1}-P_{t}$ relative to the the population size $P_t$ is held constant:
$$\frac{P_{t+1}-P_{t}}{P_t}=r.$$
</p>

<p>The idea of an environmental carrying capacity is that this relative population change is reduced as the population size increases, approaching zero as the carrying capacity is reached.  For the logistic model of equation \eqref{logistic}, the relative population change is proportional to the unused carrying capacity
\begin{align}
  \frac{P_{t+1}-P_{t}}{P_t}=r \left(1 - \frac{P_t}{M} \right),
  \label{logistic_relative_change}
\end{align}
as discussed on the {% intlink environmental_carrying_capacity %}environmental carrying capacity page{%endintlink%}.</p>

<p>We can use this relation to fit the logistic growth model to the bacteria data.  All we need to do is plot the relative population change $(P_{t+1}-P_{t})/P_t$ versus the population size $P_t$.  If we let $x=P_t$ and $y=(P_{t+1}-P_{t})/P_t$, then equation \eqref{logistic_relative_change} becomes
\begin{align*}
  y &= r\left(1 - \frac{x}{M} \right)\\
  &= r - \frac{r}{M}x.
\end{align*}
The data should lie along a line of with slope $-r/M$ and vertical intercept $r$.</p>

<p>Test to see if a plot of relative change versus population density do lie approximately along a line with negative slope.  In one column, say column F, calculate the relative population change as the ratio of the change to the population density.  Then, in another column, say column G, create the points $(x,y)$, where $x$ and $y$ are defined as above.  (The values for $x$ and $y$ should be in different columns of the spreadsheet.) This will create another set of points in plot that will get confused with the ones you created in the previous step.  You could just delete the old points or just hide them by highlighting column E, right clicking (Mac OS: Ctrl-clicking), selecting Object Properties, and clearing the Show Object box in the Basic tab.</p>

<p>Do the points seem to lie approximately along a line with negative slope?  There should be plenty of scatter, as the data comes from an actual experiment.  How do we fit a line through the data so that we can estimate the slope and vertical intercept? We could, as we {% appletlink bacteria_density_change_versus_density_line  %}did before{%endappletlink%}, just fit a line by eye.  But, especially since we need to fit two parameters, there will be too much wiggle room to find the best line.  Instead, we'll let Geogebra fit a line through the data.</p>

<p>You can let Geogebra fit the line in two ways.  In Input box at the bottom, you could type something like</p>

<p><code>FitLine[{ G2, G3, G4, G5, G6, G7, G8, G9, G10, G11}]</code></p>

<p>where there argument of the FitLine command is a list of the points to which you want to fit a line.  You can also use the <a href="http://wiki.geogebra.org/en/File:Tool_Fit_Line.gif" class="image"><img alt="Tool Fit Line.gif" src="http://wiki.geogebra.org/uploads/0/01/Tool_Fit_Line.gif" width="32" height="32" /></a> <a href="http://wiki.geogebra.org/en/Best_Fit_Line_Tool" title="Best Fit Line Tool" class="external">Best Fit Line</a> tool in Geogebra.</p>

<p>If you did this right, you should have a line that fits the data reasonably well.  Now, you just need to read off the slope and vertical intercept.  Unfortunately, it's not as easy as right-clicking  (Mac OS: Ctrl-clicking) the line and viewing its properties.</p>

<p>You have two ways of determining the slope and intercept.  One way is to open the Algebra window.  Select Algebra from the View menu.  In the Algebra window, the equation for the line will be displayed in terms of the variables $x$ and $y$. You can use the equation to calculate the slope and $y$-intercept. Alternatively, you can use the <a href="http://wiki.geogebra.org/en/File:Tool_Slope.gif" class="image"><img alt="Tool Slope.gif" src="http://wiki.geogebra.org/uploads/8/8c/Tool_Slope.gif" width="32" height="32" /></a> <a href="http://wiki.geogebra.org/en/Slope_Tool" title="Slope Tool" class="external">Slope</a> tool to determine the slope of the line.  Then, you can use the <a href="http://wiki.geogebra.org/en/File:Tool_Intersect_Two_Objects.gif" class="image"><img alt="Tool Intersect Two Objects.gif" src="http://wiki.geogebra.org/uploads/2/28/Tool_Intersect_Two_Objects.gif" width="32" height="32" /></a> <a href="http://wiki.geogebra.org/en/Intersect_Two_Objects_Tool" title="Intersect Two Objects Tool" class="external">Intersect Two Objects</a> tool to find the intersection between the line and the $y$-axis, the $y$-coordinate of which is the $y$-intercept of the line.</p>

<p>From your linear fit to the data, calculate the estimated carrying capacity $M$ and the low density growth rate $r$.  According to our model, the low density growth rate $r$ from the logistic model should be similar to the growth rate $r$ that we obtained for the {% intlink bacteria_growth_initial_model %}exponential growth fit to the initial data{%endintlink%}.  We obtained $r=2/3$ for the exponential growth fit.  Is your estimate of the low density growth rate $r$ of the logistic model similar to this value of $2/3$?  Explain your results.</p>

<p>If the bacteria population were really exhibiting exponential growth, what would the plot of $y=(P_{t+1}-P_{t})/P_t$ versus $x=P_t$ look like?  Supposedly, the first four points were pretty close to the exponential growth model.  Could the first four points on your graph be well fit by this prediction from the exponential growth model?</p>

{% navigation_tag "compare" "Compare" %}
<h4>Comparing model prediction to the data</h4>

<p>Now that you have determined the low density growth rate $r$ and the carrying capacity $M$ from the data, let's see how well the logistic model \eqref{logistic} fits the data.  We'll use the initial condition $P_0 = 0.022$ from the first data point.  Calculate the remaining $P_t$ as predicted from the logistic model and see how you did.  One procedure for doing so is as follows.</p>

<p>As described above, you can hide the points corresponding to the relative population change versus population size (or just delete them).  Then, create a column with points $(x,y)$ where $x$ is the time index (column B) and $y$ is the population size (column C).  To see these points, you'll need to rescale the $x$-axis.  One way to do so is hold down the Shift key while dragging on the $x$-axis with your mouse.  You can also right-click (Mac OS: Ctrl-click) the background of the graphics panel and select Graphics to enter the dimensions of the graphics panel directly.</p>

<p>You can easily create the logistic model predictions in the spreadsheet as well.  Label a new column with something like &ldquo;model&rdquo; and copy the first entry from Population column as the initial condition.  In the cell immediately below, type &ldquo;=&rdquo; and then then formula \eqref{logistic}, only solve it for $P_{t+1}$ first.  In every instance of $P_t$ click on the cell where you entered the initial condition.  Enter your calculated values instead of $r$ and $M$.  When you are done, you should have calculate $P_1$ based on the logistic model and $P_0$.  Simply copy this formula to the rest of the column, and the spreadsheet will automatically calculate future values.  Be sure to go all the way down to the row with time index $t=10$ (i.e., row 12).  Then, in the column to the right, you can create points $(x,y)$, where $x$ is the time index and $y$ is your newly calculated model predictions.  As described above, you can select those points, remove their labels, and change their color and style so they look different from the actual data points.</p>

<p>How did the model do?  Do the model points match up with the data points pretty well?  Does it seem like the slowing growth rate in the data can be well modeled by the carrying capacity as incorporated into the logistic growth equation?</p>

{% navigation_tag "worksheet" "Worksheet" %}
<h4>Worksheet</h4>

<p>The {% assessmentlink "bacteria_growth_logistic_model_worksheet" %}worksheet on developing a logistic model to describe bacteria growth{%endassessmentlink%} includes the main questions posed above and added a few more questions.</p>

{% endblock %}
