{% extends "midocs/page_base.html" %}{% load mi_tags %}{% load url from future %}{% block content %}
{% index_entry "Taylor polynomial" "quadratic" %}
{% title "Approximating functions by quadratic polynomials" %}
{% description "Determining how to use information from the second derivative to form a quadratic approximation to a function." %}

{% navigation_tag "predicting" "Predicting" %}
<h4>Predicting position from incomplete data</h4>

<p>Imagine the following three scenarios.
<ol>
<li>Pat is looking for Mike.  Sean tells Pat that three minutes ago
he saw Mike at the corner of First and Main (open blue point on map, below).  Where should Pat
go to find Mike?</li>
<li>Pat is looking for Mike.  Sean tells Pat that three minutes ago
he saw Mike at the corner of First and Main and he was jogging north
on Main at the rate of 2 blocks per minute.  Where should Pat go to find Mike?</li>
<li>Pat is looking for Mike.  Sean tells Pat that three minutes ago
he saw Mike at the corner of First and Main and he was jogging north
on Main at the rate of 2 blocks per minute, but Mike looked like he
was getting tired.  It seemed he was slowing his jogging rate down by a half block per minute each minute. Where should Pat go to find Mike?</li>
</ol>

{% image predicting_position_incomplete_data_map %}

<p>In all three scenarios, Pat has incomplete information, but, at least in the first two cases, it's fairly straightforward to come up with reasonably defensible answers for where Pat should go.  You could likely work them out on your own before reading on.  In the third scenario, it may be less clear what Pat should do.</p>

<p>Here's our take on advice for Pat.</p>
<ol>
<li>If Pat only knows that Mike was at First and Main three minutes ago, it
seems the best he could do is to go to First and Main and look for Mike.  The only information Pat received was on Mike's previous position, so a reasonable starting point is to assume that position didn't change much.  If the function $f(t)$ specifies our estimate of Mike's position $t$ minutes after Sean's observation of Mike, we are asserting that $f(t)$ is a constant function.  This prediction is the default scenario in the below applet.</li>
<li>If in addition, Pat knows that Mike was jogging north at 2 blocks per
minute, Pat should look for Mike 6 blocks north of First and Main, which, according to the above map, is Seventh and Main.  This assumes that Mike's jogging
remains constant for all three minutes, and that he is not, for example, running laps around the
court house at First and Main.  In other words, since we are given the derivative $f'(t)=2$ at one time, we assume that it is the derivative $f'(t)$ rather than the position $f(t)$ that remains constant.  If you check the &ldquo;running north&rdquo; box in the below applet, the prediction changes to the constant running speed scenario.</li>
<li>If it looked as if Mike was getting tired and slowing down, then the constant derivative assumption no longer seems reasonable.  Instead, the running speed $f'(t)$ is decreasing, i.e., the second derivative $f''(t)$ is negative.  Although it's arguable that this might not describe a tired runner's velocity, given that lack of additional information, we might assume that the second derivative $f''(t)$ remains constant.   Checking the &ldquo;slowing down&rdquo; box causes the applet to show the prediction that follows from keeping $f''(t)$ constant for all three minutes, fixed at the value $f''(t)=-1/2$ that was somehow estimated by Sean.   This calculation suggests that Pat should look for Mike at about Fifth or Fourth and Main.</li>
</ol>

{% boxedapplet "predicting_position_incomplete_data" %}

<p>Of course there might be other useful information that, if we knew it, would change our prediction.  For example, Mike might be eating a quick energy bar and regaining some of his strength!  Or he might have the habit of ending his jogging at the ice cream parlor on Third and Main.  Checking the &ldquo;show actual&rdquo; box in the applet shows that Mike actually slowed down even more than our final prediction, and he barely made it past Fourth and Main.  Even so, the prediction that included all the information did better than the other two predictions.</p>

<p>The reason the predictions were anywhere close to Mike's location was that three minutes was short enough of a time that Mike didn't alter his trajectory too much.  If Sean had observed Mike's position an hour in the past, we would be hard pressed to form a prediction of his location that would be accurate to within a few blocks.</p>


{% navigation_tag "beyond_tangent" "Beyond tangent" %}
<h4>Beyond tangent lines</h4>

<p>The second prediction (with &ldquo;running north&rdquo; but not &ldquo;slowing down&rdquo; checked in the above applet) used the tangent line to the actual function $f(t)$ evaluated at one time to predict a future location.  Check the &ldquo;show actual&rdquo; box to see how the green diagonal line in the right panel is a tangent line to the cyan curve.</p>

<p>The information for this second prediction was equivalent to being told that $f(0)=1$ and $f'(0)=2$.  The equation for the tangent line is then
\begin{align*}
  L(t) = f(0) + f'(0)t
\end{align*}
or
\begin{align*}
  L(t) = 1 + 2t.
\end{align*}
If we approximate $f(t)$ by $L(t)$, then we calculate the predicted location at time $t=3$ to be $L(3)=1+6=7$.  This was our basis for estimating Mike's location to be at Seventh and Main in the second scenario.</p>

<p>But how did we come up with the prediction for the third scenario when we were given in addition that $f''(0)=-1/2$?  The natural extension beyond a tangent line would be a quadratic approximation, with a quadratic term that would take into account the information from the second derivative.  Maybe we should just add the term $f''(0) t^2$ to the linear approximation $L(t)$?</p>

{% navigation_tag "beyond_tangent" "Beyond tangent" "Graphical exploration" %}
<h5>Graphical exploration</h5>

<p>Let's test this guess out using the below applet.  Rather than using Mike's location function, we'll start with the default function for the applet, which is
\begin{align*}
  f(x) = x^3+2x^2+x/2-1.
\end{align*}
The applet calculates the derivatives for you, showing that $f(0)=-1$, $f'(0)=0.5$, and $f''(0)=4$.  This means that the tangent line approximation to $f(x)$ at $x=0$ is
\begin{align*}
  L(x) = -1 + 0.5x,
\end{align*}
shown by the thin red line.</p>

<p>How much is the approximation improved if we add the term $f''(0)x^2 = 4x^2$ to the linear approximation?  The thin blue curve is the quadratic approximation, where the coefficient on the quadratic term is the number $c$, which for our case is
\begin{align*}
  Q(x) = -1 + 0.5x + cx^2.
\end{align*}
The default value for $c$ is 4.  How well does the quadratic approximation fit the function $f(x)$ for this choice of $c$?</p>

<p>Recall the tangent line approximation $L(x)$ is a good approximation of the function near the point where it was calculated (here $x=0$), so that the graph of the tangent line and the function itself become indistinguishable as you zoom in.  We would like to create a quadratic approximation $Q(x)$ that is also valid near that point, but captures the initial deviation from the tangent line as one moves away from the point.</p>

<p>To evaluate the fit of $Q(x)=-1+0.5x + 4x^2$ to $f(x)$ around $x=0$, zoom in on the point at $x=0$ (the purple point in the applet).  Does it seem like the thin blue curve of $Q(x)$ is capturing the curvature of the thick green curve of $f(x)$ away from the red tangent line $L(x)$?  Do you think that you can obtain a better fit with different values of $c$?  Try different values of $c$ to find the one that gives the best match around the point $x=0$.  How does this best value compare to the derivative $f''(0)$?</p>

{% boxedapplet "quadratic_approximation" %}

<p>We can calculate quadratic approximations at other points besides $x=0$.  The tangent line to $f(x)$ around $x=a$ for any value of $a$ is
\begin{align*}
  L(x) = f(a) + f'(a)(x-a).
\end{align*}
If we add a quadratic term, it must be of the form $c(x-a)^2$ so that $Q(a)=f(a)$ (and $Q'(a)=f'(a)$, as we'll see below).  Our quadratic approximation will therefore be of the form
\begin{align*}
  Q(x) = f(a) + f'(a)(x-a) + c(x-a)^2.
\end{align*}
Based on your above experiments with $x=a$, what do you think you should choose for $c$?  Is $c=f''(a)$ a good choice or can you find something better?  Try changing $a$ in the above applet and test your prediction for $c$.  Can you find the best value so that $Q$ is as close as possible to $f$ as you zoom in around the point at $x=a$?</p>

<p>Presumably your value of $c$ depends on $f''(a)$.  In the applet, you can enter an expression in terms of $f''(a)$ in the box for $c$.  That way, the value for $c$ will adjust automatically as you change $a$.  What formula did you come up with for $c$ in terms of $f''(a)$?</p>

{% navigation_tag "beyond_tangent" "Beyond tangent" "Analytic calculation" %}
<h5>Analytic calculation</h5>

<p>The next step is to use calculus to verify your formula for $c$.  The quadratic approximation to $f(x)$ around $x=a$ is
\begin{align*}
  Q(x) = f(a) + f'(a)(x-a) + c(x-a)^2.
\end{align*}
We can show analytically how it is a good approximation.  First, $Q(a)=f(a)$, so it matches the value of the function at $x=a$.</p>

<p>If we didn't mess up, $Q(x)$ should match the first derivative of $f$ at $x=a$ as well.  Check that this is true.  Calculate the derivative $Q'(x)$ based on the above formula.  Remember that $c$ and $a$ are just numbers so that, for example,
\begin{align*}
  \diff{}{x} f(a) = 0
\end{align*}
and 
\begin{align*}
  \diff{}{x}(x-a) =1.
\end{align*}
Once you calculate $Q'(x)$, plug in $x=a$ to make sure that $Q'(a)=f'(a)$.  We chose the extra term $c(x-a)^2$ so that its derivative is zero at $x=a$.  That way, adding $(x-a)^2$ to the tangent line $L(x)$ wouldn't alter the property of being tangent to $f(x)$ at $x=a$.</p>

<p>Assuming that you showed that $Q'(a)=f'(a)$, now is the time to figure out (or confirm) what we should use for $c$.  Starting with $Q'(x)$ (not $Q'(a)$ where you substituted $x=a$), differentiate again to obtain an expression for $Q''(x)$.  The linear term should disappear here, so you just be left with second derivative of the quadratic term $c(x-a)^2$.  Plug in $x=a$ to calculate $Q''(a)$.  (If $x$ doesn't happen to appear in $Q''(x)$, that's OK.  In this case, plugging in $x=a$ doesn't do anything.)</p>

<p>What do we want $Q''(a)$ to be equal to?  We want it to be equal to the second derivative of $f$ itself, i.e., $Q''(a)=f''(a)$.  Since $f''(a)$ is just some number, the equation $Q''(a)=f''(a)$ should allow you to calculate an expression for $c$ in terms of that number.</p>

<p>What is your formula for $c$ in terms of $f''(a)$?  How does it compare with formula you obtained with your graphical exploration above?  If you obtained a different answer with your graphical exploration, go back and check if you get an even better match graphically by putting in your new formula for $c$ into the applet.</p>

<p>If your new formula doesn't give you a good match in the applet as you zoom in around the point at $x=a$, then something is wrong with your formula.  Check your calculation again.  See if you can reconcile the results from both methods so that you have just one formula for $c$.</p>

<p>What is your final expression for the quadratic approximation $Q(x)$?</p>


{% navigation_tag "predicting_redux" "Predicting redux" %}
<h4>Predicting position redux</h4>

<p>Now you know enough to go back to predicting Mike's position $f(t)$.  In scenario three, above, we can write the data as $f(0)=1$, $f'(0)=2$, and $f'(0)=-1/2$.  Given the formula you obtained for $Q$, what is the quadratic approximation to $f(t)$ from this data?</p>

<p>Mike's actual position was given by 
\begin{align*}
  f(t) = 1 + 2t - \frac{t^2}{4} - \frac{t^3}{10}+ \frac{t^4}{40}
\end{align*}
for $0 < t < 3$.  If you enter this function into the above quadratic approximation applet (type the variable as $x$ rather than $t$), set $a=0$, and put in your formula for $c$, you should be able to reproduce the result from the first applet when the &ldquo;slowing down&rdquo; box is checked.</p>

<p>How well does the quadratic approximation based at $t=0$ predict Mike's position for times $t$ greater than 3 minutes?  How about for times before Sean saw Mike, i.e., for negative $t$?  (Of course, if $t$ becomes too large, $f(t)$ can't be a realistic representation of Mike's position, as it will have him running really fast.)</p>


<aside class="lookdeep">

<h4>Taylor polynomials</h4>

<p>The linear approximation $L(x)$ and the quadratic approximation $Q(x)$ (with the correct formula for $c$) are examples of Taylor polynomials for the function $f(x)$.  As you might imagine, one can calculate higher order Taylor polynomials based on higher order derivatives of $x$.  For example, one can obtain a cubic Taylor polynomial with the addition of information about the third derivative $f'''$.</p>

<p>To find out more, you can check out a {% appletlink taylor_polynomial %}Taylor polynomial applet{%endappletlink%} or read about <a href="{% url 'mithreads-thread' 'calculus_refresher' %}#taylor_polynomials">Taylor polynomials from the Calculus Refresher</a>.</p>
</aside>

{% navigation_tag "questions" "Questions" %}
<h4>Summary of questions</h4>

<p>To aid you in writing up a report on your results, we summarize the main questions posed above that you should be able to answer and added a few more questions.</p>

<ol>
  <li><p><b>Predicting position from incomplete data</b></p>

    <ol><li>Explain the assumptions made for the predictions based on the available information for the three scenarios.  Do these seem like reasonable assumptions?</li>
      <li>Can you think of a more reasonable option for the third scenario?</li>
    </ol>
  </li>
  <li><p><b>Graphical exploration</b></p>
    <ol>
      <li>How well did the quadratic approximation around $x=0$ fit the function $f(x)$ for the choice of $c=4$?  Did it seem like the thin blue curve of $Q(x)$ was capturing the curvature of the thick green curve of $f(x)$ away from the red tangent line $L(x)$?  Describe your observations.</li>
      <li>Were you able to obtain a better fit with different values of $c$?  What value gave the best match around the point $x=0$. How does this best value compare to the second derivative $f''(0)$?</li>
      <li>For calculating the quadratic approximation around the point $x=a$, what value of $c$ did you find produced the best fit. What formula did you come up with for $c$ in terms of $f''(a)$?</li>
    </ol>
  </li>
  <li><p><b>Analytic calculation</b></p>
    <ol>
      <li>Show the calculation demonstrating that $Q'(a)=f'(a)$</li>
      <li>Show the calculation by which you used the condition $Q''(x)=f''(a)$ to come up with (or verify) your formula for $c$ in terms of $f''(a)$.</li>
       <li>How does this formula compare with formula you originally obtained with your graphical exploration?  Did you need to make modifications to one of your formulas to make them match?</li>
      <li>Give your final expression for the quadratic approximation Q(x).</li>
    </ol>
  </li>
  <li><p><b>Predicting position redux</b></p>
    <ol>
      <li>What is the quadratic approximation to $f(t)$ from the data of the third scenario?</li>
      <li>How well does the quadratic approximation based at $t=0$ predict Mike's position for times $t$ greater than 3 minutes?  How about for times before Sean saw Mike, i.e., for negative $t$?</li>
    </ol>
  </li>
</ol>


{% endblock %}
