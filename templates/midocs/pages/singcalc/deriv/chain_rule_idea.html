{% extends "midocs/page_base.html" %}{% load mi_tags %}{% block content %}
{% index_entry "derivative" "chain rule" %}
{% index_entry "chain rule" %}
{% index_entry "differentiation rules" "chain rule" %}
{% title "The idea of the chain rule" %}
{% description "An illustration of the basic concept of the chain rule using interactive graphics to diagram the relevant points on the graphs and the corresponding slopes." %}


<p>The chain rule gives us a way to calculate the derivative of a {% intlink function_composition %}composition{%endintlink%} of functions, such as the composition $f(g(x))$ of the functions $f$ and $g$.  The chain rule can be tricky to apply correctly, especially since, with a complicated expression, one might need to use the chain rule multiple times.  Nonetheless, the idea of the chain rule can be understood fairly simply.</p>

<p>The following video outlines the basic idea of the chain rule.  In the remainder of this page, we illustrate the idea of the chain rule in three ways.  <a href="#function_machines">First</a>, we illustrate the concept using {%intlink function_machine %}function machines{%endintlink%}.  <a href="#linear_functions">Second</a>, we show how for linear functions, the chain rule is just the product of the slopes of the function graphs.  <a href="#nonlinear_functions">Third</a>, we show that for nonlinear functions, the chain rule is just the product of the slopes of the tangent lines to the function graphs.  Examples of the chain rule are given on {% intlink chain_rule_simple_examples %}another page{%endintlink%}.</p>

{% navigation_tag "video_introduction" "Video introduction" %}
<h4>Video introduction</h4>

{% boxedvideo "chain_rule_idea" %}


{% navigation_tag "function_machines" "Function machines" %}
<h4>The chain rule of function machines</h4>

<p>The {% intlink function_composition %}composition{%endintlink%} of $f(g(x))$ of two functions $f$ and $g$ can be visualized as {% intlink function_machine_composition %}hooking up two function machines{%endintlink%} so that the output of $g$ becomes the input of $f$.  Let's call the combined function $h(x)$ so that $h(x)=f(g(x))$.  (Sometimes, we write the composition as $h=f \circ g$, so that the large function machine, below, labeled $f \circ g$ illustrates $h$.)</p> 

<div class="ym-grid linearize-level-2">
  <div class="ym-g50 ym-gl">
    <div class="ym-gbox-left">
      {% image function_machines_composed %}
    </div>
  </div>
  <div class="ym-g50 ym-gr">
    <div class="ym-gbox">
      {% image function_machines_composed_combined %}
    </div>
  </div>
</div>

<p>In the above illustration of function machines, $h$ is the function that transforms the sphere input at the top all the way into the faceted sphere output at the bottom.  The input to $h$ is the input to $g$, and the output of $h$ is the output of $f$. The derivative of $h$ tells us how much the output $h$ will change if we change its input a little bit, i.e., it is the ratio of the change in the output of $h$ to the change in its input (equivalently, the  ratio of the change in the output of $f$ to the change in the input of $g$).  Paraphrasing the limit definition of the derivative, we could write this as
\begin{align*}
  h' &= \lim_{\text{small changes}}\frac{\text{change in output of $h$}}{\text{change in input to $h$}}\\
   &= \lim_{\text{small changes}}\frac{\text{change in output of $f$}}{\text{change in input to $g$}}.
\end{align*}
</p>

<p>The chain rule calculates this derivative by following the chain of events that occur when we change the input to $g$ and observe the resulting change in the output of $f$.  A change in the input to $g$ (the sphere) first causes a change in the output of $g$ (the cube).  This leads to the same change in the input to $f$ (the same cube), resulting finally in a change in the output of $f$ (the faceted sphere).</p>

<p>In the function machine picture, the derivative of $h$ is the ratio between the change in the faceted sphere to the change in the sphere.  The derivative of $g$ is the ratio of the change in the cube to the change in the sphere while the derivative of $f$ is the ratio of the change in the facet sphere to the change in the cube.  If we multiply the ratios corresponding to the derivatives of $g$ and $f$, the factors corresponding to the change of the cube cancel, and we obtain the ratio corresponding to the derivative of $h$.  If we think of the $d$ from the notation for derivative as denoting &ldquo;change in,&rdquo; we can write the result of the chain rule in terms of the function machine inputs and outputs as the following.</p>

{% image chain_rule_geometric_objects %}

<p>In terms of the derivatives of the functions, we can write the chain rule as $$h' = f' \cdot g'.$$  We need to be careful to evaluate the derivatives at the correct points.  If we denote the input to $g$ as $x$ (the sphere), then we must evaluate the derivative of $g$ at $x$, using $g'(x)$.  Since the input to $g$ is the input to $h$, we must also evaluate the derivative of $h$ as $x$, using $h'(x)$.  The sphere (or $x$), however, is not what goes into the $f$ machine.  Instead, the cube goes into the $f$ machine.  Consequently, we must evaluate the derivative of $f$ at the cube.  What is the cube?  The cube is the output of the $g$ machine when we put in the sphere (or $x$).  The output of $g$ is $g(x)$, so we must evaluate the derivative of $f$ at $g(x)$, using $f'(g(x))$ in our chain rule formula.  The resulting chain formula is therefore
\begin{gather}
  h'(x) = f'(g(x))g'(x).
  \label{chain_rule_formula}
\end{gather}
</p>


{% navigation_tag "linear_functions" "Linear functions" %}
<h4>The chain rule for linear functions</h4>

<p>The derivative of a function is based on a linear approximation: the tangent line to the graph of the function.  For this reason, we can often obtain intuition about the properties of the derivative just by looking at linear functions.  The chain rule, in particular, is very simple for linear functions.  As we'll see, one important subtlety of the chain rule is absent with linear functions, so they serve as a good starting point to gaining intuition about the chain rule.</p>

{% navigation_tag "linear_functions" "Linear functions" "The simple form"%}
<h5>The simple form</h5>

<p>If $g$ and $f$ are linear functions, we can write them as
\begin{align*}
  g(x) &= ax+b\\
  f(x) &= cx + d\\
\end{align*}
where $a$, $b$, $c$, and $d$ are parameters determining the slopes and vertical intercepts of the functions.  See the left panel of the below applet, where $g$ and $f$ are graphed by the thick blue and thin cyan lines, respectively.  The  {% intlink function_composition %}composition{%endintlink%} of $f$ and $g$ is
\begin{align*}
  h(x) &= f(g(x))\\
  &= f(ax +b)\\
  &= c(ax+b)+d\\
  &= acx + bc+d.
\end{align*}
The graph of $h$ is a line with slope $ac$ and vertical intercept $bc+d$, graph by the thick green line in the right panel in the below applet.</p>

<p>Since $f$, $g$, and $h$ are linear functions, their derivatives (i.e., the slopes of their tangent lines) are simply equal to the slopes of the lines themselves.  In other words, $f'(x)=c$, $g'(x)=a$, and $h'(x)=ac$ independent of the value of $x$.  In this case, it's simple to see that the derivative $h'(x)$ is equal to the product of the derivatives $f'$ and $g'$.</p>

<p>In fact, the derivatives don't depend on the intercepts $b$ and $d$, so imagine the special case that $b=d=0$.  In this case, $g(x)=ax$ so it multiplies its input $x$ by the slope $a$.  The function $f(x)=cx$ multiplies its input by the slope $c$.  Finally, in this special case $h$ simpliy multiplies its input by both $a$ and $c$, so its slope is $ac$.  What could be simpler?  The chain rule simply states that obvious fact that multiplying by $a$ followed by multiplying by $c$ is the same thing as multiplying by the single number $ac$.</p>

<p>Even if $b \ne 0$ or $d \ne 0$, the chain rule isn't much more difficult as those numbers don't affect the slopes.  We still just multiply the derivative $a$ by the derivative $c$ to get the derivative of the composition $ac$.</p>

{% navigation_tag "linear_functions" "Linear functions" "A caution"%}
<h5>A caution</h5>

<p>The reason for the simple form of the chain rule for linear functions is that the derivatives were constants, independent of the value of the inputs to the functions.  From experimenting with linear functions, one might falsely assume that the derivative $h'(x)$ of the composition $h(x)=f(g(x))$ might be equal to the product of the derivative $f'(x)$ times the derivative $g'(x)$.  The actual chain rule of equation \eqref{chain_rule_formula} has important difference.  In using the chain rule, one must be careful to evaluate the derivative of $f$ at $g'(x)$ and use the valid chain rule $h'(x)=f'(g(x))g'(x)$.</p>

<p>The following applet illustrates the chain rule for linear functions.  Even though it doesn't make a difference for linear functions, the applet shows graphically the correct points (the green symbols) where one must evaluate the derivatives of $f$ and $g$.  If you understand how these points are calculated, then you'll correctly compute the chain rule even for nonlinear functions.  Since almost every case where we want to use the chain rule will involve nonlinear functions, evaluating the derivatives at the right points is a crucial step.</p>

<p>The red arrows in the left panel illustrate how to graphically calculate $h(x)=f(g(x))$ where $x=x_0$.  The conventions are nearly identical to those one uses for {% intlink cobwebbing_graphical_solution %}cobwebbing the solution to function iteration{%endintlink%}.</p>

<p>Starting at the red point for $x_0$, one moves vertically to calculate $g(x_0)$, which would be the height of the point (green diamond) where one hits the graph of $g$.  To translate $g(x_0)$ from the vertical axis to the horizontal axis, one must move horizontally to the graph of the diagonal $y=x$.  At that point, the value for the horizontal coordinate and vertical coordinate are the same; both coordinates are equal to $g(x_0)$.  Then, to calculate $h(x_0)=f(g(x_0))$, one just moves vertically to the graph of $f$.  The vertical coordinate of this point (the green triangle) is the required $f(g(x_0))$.</p>

<p>Since to calculate $h(x_0)$, the function $g$ is evaluated at $x_0$ and the function $f$ is evaluated at $g(x_0)$, these are the places where one needs to calculate the derivatives of $g$ and $f$, respectively.  Even though the derivative for the case of linear functions doesn't depend on those points, one can still use the applet to remember that $h'(x_0)=f'(g(x_0))g'(x_0).$</p>

{% boxedapplet "chain_rule_linear_functions" %}

{% navigation_tag "nonlinear_functions" "Nonlinear functions" %}
<h4>The chain rule of nonlinear functions</h4>

<p>If you understand the chain rule for linear functions, including where to evaluate the derivative, there isn't much more to understanding the chain rule for nonlinear functions.  The only difference is that the tangent line to the graph of a nonlinear function does depend on the point at which you calculate the tangent line.  Just as above, if you realize that to calculate $h(x_0)$ one must evaluated $g$ at $x_0$ and $f$ at $g(x_0)$, then it makes sense that $h'(x_0)=f'(g(x_0)) g'(x_0)$.</p>

<p>The following applet uses the same conventions as the above applet.  It just is a lot messier than the above linear version because we need to plot the tangent lines which depend on the points where we evaluate the functions.  The applet makes it clear that we'd get the wrong answer if we examined the slope of $f$ at $x_0$ rather than $g(x_0)$.  The applet doesn't show the wrong tangent line with slope $f'(x_0)$ (that would make it too confusing). But you can see that the function $f$ does in general have a different slope above the point $x_0$ than it does at the green triangle.</p>

{% boxedapplet "chain_rule_multiply_slopes" %}

<p>This page focused exclusively on the idea of the chain rule.  Of course, knowing the general idea and accurately using the chain rule are two different things.  If you are new to the chain rule, check out some {% intlink chain_rule_simple_examples %}simple chain rule examples{% endintlink%}.  If you want to see some more complicated examples, take a look at the {% intlink chain_rule_refresher %}chain rule page from the Calculus Refresher{% endintlink%}.</p>

{%endblock %}
