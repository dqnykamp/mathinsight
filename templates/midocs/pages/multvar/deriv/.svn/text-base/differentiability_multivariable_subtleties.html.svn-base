{% extends "midocs/page_base.html" %}{% load mi_tags %}{% block content %}
{% index_entry "differentiability" "subtleties"%}
{% title "Subtleties of differentiability in higher dimensions" %}
{% description "A description of some of the tricky ways where a function of multiple variables can fail to be differentiable. Example two variable functions are illustrated with interactive graphics." %}

{% navigation_tag "definition" "Definition" %}
<h4>The definition of differentiability</h4>

<p>The definition of differentiability in higher dimensions looks
fairly intimidating at first glance.
For this reason, we suggest beginning by reading the page about
{% intlink differentiability_multivariable_definition %}the 
intuition behind this definition{%endintlink%}. 
We repeat the definition from the end of that page.</p>


<p><b>Definition</b>: The function $\vc{f}: \R^n \to \R^m$ is 
<i>differentiable</i>
 at the point $\vc{a}$ if there exists a {%intlink linear_transformation_definition_euclidean %}linear transformation{%endintlink%} $\vc{T}: \R^n \to \R^m$ that satisfies the condition
$$\lim_{\vc{x} \to \vc{a}} 
\frac{\| \vc{f}(\vc{x})-\vc{f}(\vc{a}) - \vc{T}(\vc{x}-\vc{a})\|}{\|\vc{x}-\vc{a}\|} = 0.$$
</p>

<p>The $m \times n$ {% intlink matrices_linear_transformations %}
matrix associated with the linear transformation{%endintlink%}
$\vc{T}$ is the {% intlink derivative_matrix %}matrix of partial derivatives{%endintlink%}, which we denote
by $\jacm{f}(\vc{a})$.
We can refer to $\jacm{f}(\vc{a})$ as the <i>total derivative</i> 
(or simply the <i>derivative</i>) of $\vc{f}$.
</p>

{% navigation_tag "limits" "High-D limits" %}
<h4>The trouble with limits in higher dimensions</h4>

<p>The differentiabililty definition is based on the limit 
$\vc{x} \to \vc{a}$.  
In order for this limit to exist, 
we have to get the same result, no matter the route $\vc{x}$
takes on its way to $\vc{a}$.  
If we find two routes that give different values for this limit,
then we can conclude the limit does not exist.
In many of the subtle cases where a function fails to be differentiable,
one can find linear transformations $\vc{T}$ where 
$$\frac{\| \vc{f}(\vc{x})-\vc{f}(\vc{a}) - \vc{T}(\vc{x}-\vc{a})\|}{\|\vc{x}-\vc{a}\|}$$
does go to zero when $\vc{x}$ approaches $\vc{a}$ along some routes,
but it does not go to zero when $\vc{x}$ approaches $\vc{a}$ along other routes.
Don't make the mistake concluding a function must be differentiable
after checking that you get zero along just a few paths of $\vc{x} \to \vc{a}$.
</p>

<p>For a scalar-valued function of one variable, $f(x)$,
checking that this limit is zero isn't too difficult.
On the real line, there are only two routes for $x$ to get to $a$.
It can approach $a$ from above or from below.  
If we find a candidate tangent line 
$$L(x)=f(a)+T(x-a)=f(a)+m(x-a)$$
where the upper and lower limits 
are both zero, then we can conclude that we really found a tangent line and the function is differentiable.</p>

<p>On the other hand, as pictured below, we may be able to find one
candidate tangent line (in blue) where the limit is zero from the left
but not the right.  And we may find a second candidate tangent line (in red)
where the limit is zero from the right and not the left.
But in this case, it easy to see what is happening and to identify
the kink in $f(x)$ that makes it non-differentiable at $x=a$.
</p>

<p class="centeredImage">{% image two_tangents_left_right %}</p>

<p>Increasing the number of dimensions to two or more makes a limit
become much more complicated.
Now, one has to consider all the possible paths $\vc{x}$ could take to the point $\vc{a}$, such as the ones illustrated below for the case of two dimensions.
The challenge is the fact that there are an infinite number of such paths, 
and one needs to get the same limiting value on all these paths in order for the limit to exist.
</p>

<p class="centeredImage">{% image limit_many_paths_two_dimensions %}</p>

{% navigation_tag "understanding" "Understanding in 2D" %}

<h4>Understanding the differentiability condition in two dimensions</h4>

<p>To develop an intuition of the subtle ways in differentiability
condition could be violated, it's enough to stick with 
scalar-valued functions of two variables, $f: \R^2 \to \R$.
In this case, we can plot the graph of $f$ as a surface, 
and we understand that the linear approximation 
$$L(\vc{x}) = f(\vc{a}) + T(\vc{x}-\vc{a})$$
is a tangent plane.</p>

<p>We will also leave our formal definition of differentiability aside,
and just focus on the geometry of the tangent plane.  
You can gather intuition about the correspondence between this definition 
and tangent lines in {% intlink differentiability_multivariable_definition%}the
page on the definition of differentiability{%endintlink%}. 
The differentiability definition requires the tangent plane to be tangent to the graph
along any path of $\vc{x}$ that goes to the point $\vc{a}$.</p>


<p>The important consequence of this fact is that the existence of a
derivative is much stronger than the existence of partial derivatives.
Partial derivatives involve the limit of $\vc{f}$ only along
directions parallel to the coordinate axes (in the above picture, such
limits would be arrows coming straight in from the left, right, top,
and bottom). </p>

<p>If a function varies smoothly along the paths coming into
$\vc{a}$ from the positive and negative $x$ directions, the partial
derivative with respect to $x$ at the point $\vc{a}$ will exist.  If a
function varies smoothly along the paths coming in from the positive
and negative $y$ directions, the partial derivative with respect to $y$
at the point $\vc{a}$ will exist.</p>

<p>But just because the function behaves &ldquo;nicely&rdquo; along those four
directions, it doesn't mean it behaves nicely along every path coming
into $\vc{a}$.  </p>

<p>For example, look at the following surface.  At the origin (i.e.,
$\vc{a}=(0,0)$), the partial derivatives exist and are zero. (If one
moves in the positive or negative $x$ or $y$ direction, the function
is constant.)</p>

{% boxedapplet nondifferentiable_function_partial_derivatives %}

<p>However, if you approach the origin from a path coming from any other
direction, the slope of the path will be nonzero.  You'll be climbing
uphill as you reach the origin (or possibly going downhill if you changed the surface to remove the folds).</p>

<p>If the function were differentiable at the origin, it would have a
tangent plane at the origin. 
If a tangent plane existed, the slopes would have to match the partial
derivatives.  In this case, since the
partial derivatives are zero, the only option for the tangent plane is
the horizontal plane, as shown below.  Clearly this plane is not a
tangent plane, as it is not tangent to paths approaching the
origin from all directions.  This surface is a graph of a function
that has partial derivatives at the origin but is not differentiable
at the origin.</p>

{% boxedapplet nondifferentiable_function_partial_derivatives_no_tangent_plane %}

<p>For the above figures, if you drag the blue dot on the sliders, you can
look at other surfaces that are not differentiable. The partial
derivatives at the origin do not change, so the candidate for the
tangent plane is still the horizontal.  However, you can see that the
horizontal plane is not a tangent plane.</p>

<p>Note that for these functions, you could write down the matrix of
partial derivatives.  It would  simply  be $[0 \, 0]$.  But that
matrix <b>would not</b> correspond to the derivative.</p>

<a id="examplefunction"></a>
<h4>Further example</h4>

<p>The following is another example function that has partial derivatives at
the origin but is not differentiable.  For this example, we have an
equation for the function.
\begin{align*}
  f(x,y) = 
  \begin{cases}
    \displaystyle
    \frac{x^2y}{x^2+y^2} &amp; \text{if } (x,y) \ne (0,0)\\
    0 &amp; \text{if } (x,y) = (0.0)
  \end{cases}
\end{align*}
</p>

<p>
The graph of the function is shown below.</p>

{% boxedapplet nondifferentiable_function_partial_derivatives_2 %}

<p>We can show partial derivatives exist at (0,0) but that function is not
differentiable at (0,0).  Since this function is defined in piecewise fashion
around the origin, there are no simple formulas for the partial derivatives.
We have to use the {%intlink partial_derivative_limit_definition %}limit definition{%endintlink%} of the partial derivatives.
For the partial derivative with respect to $x$, this formula is
\begin{align*}
  \pdiff{f}{x}(0,0) &amp;=
  \lim_{h \rightarrow 0} \frac{f(0+h,0)-f(0,0)}{h}.
\end{align*}
Since $f(0,0)=0$ and  $f(0+h,0)=f(h,0) = 0$, we calculate
\begin{align*}
  \pdiff{f}{x}(0,0) &amp;=
  \lim_{h \rightarrow 0} \frac{f(0+h,0)-f(0,0)}{h}\\
  &amp;= \lim_{h \rightarrow 0} 
  \frac{0- 0}{h}
  = \lim_{h \rightarrow 0} 
  0 =0.
\end{align*}
Similarly, you can show that $\displaystyle \pdiff{f}{y}(0,0)=0$.
</p>


<p>If the function had a tangent plane at (0,0), then it would have to
be the flat plane with equation $z=f(0,0)=0$.</p>

{% boxedapplet nondifferentiable_function_partial_derivatives_no_tangent_plane_2 %}


<p>As you may see from the graph, if one approaches the origin along a diagonal,
the tangent to the path would not be in the plane $z=0$.</p>

<h4>Overcoming subtleties</h4>

<p>Thankfully, in many cases, there is a simple way to overcome these subtleties and know for sure that a function is differentiable.
The {%intlink differentiability_multivariable_theorem %}differentiability theorem{%endintlink%} tells us that a function with continuous partial derivatives must be differentiable and therefore cannot have any of the crazy behavior of the above examples.
By the same token, since the above functions are not differentiable, they must have discontinuous partial derivatives.  
For the latter example, we can visualize how it indeed has {%intlink nondifferentiable_discontinuous_partial_derivatives%}discontinuous partial derivatives{%endintlink%}.

{%endblock%}
